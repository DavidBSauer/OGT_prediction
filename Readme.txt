Scripts for Regression of OGT against genome derived features (Sauer & Wang. 2018)
requirements: 	Barrnap, GenemarkS, bedtools, tRNAscan-SE

contents of each directory:

Ubuntu_setup.sh - a shell script for setting up a new Ubuntu install

data: 	
List of genomes used, genome derived features, species taxonomic assignment, and the train-test list used
	Genome_xxx.txt: the features calcuated per genome, tab delimited
	species_taxonomic.txt: the species taxonomy file, tab delimited
	genomes_retrieved.txt: the genome-species pairs used in this analysis, tab delimited
	train_test_list.txt: the train-test list used for regression
	Genome_barrnap_assignment.txt: Superkingdom assignment of each genome based on barrnap

feature_calculation:
For the retrieval of species taxonomic information from NCBI
	Run as: python clade_retriever.py list_of_species email_address
		where: list_of_speies is a file of species with each species on its own line

	output: "species_taxonomic.txt" - species taxonomy file, tab delimited 

For the retrieval of genomes:
	run as: python genome_retriever.py species_taxonomic.txt

	output: "genomes" - folder containing subfolders of each species, with genomes within
		"genomes_retrieved.txt" - tab delimited file of genomes-species retrieved

For the calculation of features for each genome
	Requires that "external_tools.txt" be edited to give the command for launching each of the required programs 

	Run as: python feature_calculation_pipeline.py genomes_retrieved.txt species_taxonomic.txt
	Output: "Genome_xxx.txt" feature files for each class of feature calculated, log file


regression:
For the regression of individual features and multiple linear regression of OGTs from genome
	Run as: python regression_pipeline.py species_OGT_file train_test_list.txt species_taxonomic.txt Genome_feature_files...
		note: train_test_list can be run as "NONE" to randomly generate a new train-test list

	Output: "regression_pipeline.log" - log file of linear and multi-linear regressions
		two directories "files" and "figures".
			within "files": 	directory "cross_correlation" - files of association as |r| between features for all, Archaea, and Bacteria, as tab delimited files
						directory "individual_features" - files of OGT and feature for each feature and taxonomic rank examined, as tab delimited files
						directory "predictions" - predictions of OGT for each taxonomic rank examined, for both train and test species, as tab delimited files
						directory "regression_models" - files of the best multiple linear regression models for each taxonomic rank examined, as tab delimited files
						file "species_genomes.txt" - file of each species and the number of genomes analyzed, as tab delimited file
						file "species_average_features.txt" - file of all features averaged by species, as tab delimited file
						files "histogram_xxx.txt" - histogram data of OGT distribution for xxx taxonomic rank
						files "feature_correlation_xxx.txt" - files of OGT-feature correlations (r) for xxx taxonomic rank
						files "species_list_xxx.txt" - list of species for xxx taxonomic rank
			
			within "figures":	file "species_feature_OGT.png" - venn diagram of species with OGT data, and species with feature data
						files "feature_assignment_xxx.png" - venn diagram of features for each species, for xxx taxonomic rank
						files "regression_xxx.png" - plot of predicted versus measured OGTs using best multiple linear regression, for xxx taxonomic rank 
						directory "individual_featuers" - plots of individual features versus OGT for each taxonomic rank examined
						directory "cross_correlation" - plots of association as |r| between features for all, Archaea, and Bacteria

prediction:
Folder includes "clade_retriever.py" and "genome_retriever.py", same purpose and execution as above

For the prediction of a given set of genomes, possibly excluding those genomes with a previously measured OGT	
	Requires that "external_tools.txt" be edited to give the command for launching each of the required programs 
	
	Run as: python prediction_pipeline.py regression_model_directory genomes_file species_taxonomy_file
		where:	regression_model_directory - a directory which contains linear regression models of the type generated by regression/regression_pipeline.py
			genomes_file - file of genomes and "species" names, where multiple genomes with the same species name will be averaged. tab delimited file
			species_taxonomy_file - file of taxonomic assignment for each species to be analyzed
		note:	data should be stored as a compressed genome fasta files (.fa.gz), with the structure /genomes/xxx/ where xxx is the species name 
		
		Output:	"OGT_calculation.log" - log file of genome, species, and taxonomic retrieval, feature calculation, and OGT prediction
			"newly_predicted_OGTs.txt" - a file of newly predicted species-OGT pairs
